FROM node:alpine

ARG APP_PORT
ARG POSTGRES_HOST
ARG POSTGRES_DB
ARG POSTGRES_USER
ARG POSTGRES_PASSWORD

COPY ["package.json", "package-lock.json", "/usr/app/"]

WORKDIR /usr/app

RUN npm install
COPY [".", "/usr/app"]

ENV APP_PORT=$APP_PORT
ENV POSTGRES_HOST=$POSTGRES_HOST
ENV POSTGRES_DB=$POSTGRES_DB
ENV POSTGRES_USER=$POSTGRES_USER
ENV POSTGRES_PASSWORD=$POSTGRES_PASSWORD
ENV DEBUG=b:*

CMD ["npx", "nodemon", "./src/app.js"]
